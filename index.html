<!doctype html>
<html>
  <head>
    <style>
      :root {
        --playing-field-border-width: 1px;
      }

      body {
        align-items: center;
        background-color: cyan;
        display: grid;
        grid-template-rows: min-content 1fr;
        height: 100dvh;
        justify-items: center;
        margin: 0;
        user-select: none;
      }

      #octocat {
        position: absolute;
        transition: all 0.5s;
        width: 5dvw;

        &:hover {
          cursor: grab;
        }
      }

      #playing-field {
        border: var(--playing-field-border-width) solid black;
        height: calc(100% - 2 * var(--playing-field-border-width));
        position: relative;
        width: calc(100% - 2 * var(--playing-field-border-width));
      }
    </style>
  </head>

  <body>
    <p id="scoreText">Score: 0</p>

    <div id="playing-field">
      <img id="octocat" src="octocat.png" />
    </div>
  </body>

  <script>
    const octocat = document.getElementById("octocat");
    const scoreText = document.getElementById("scoreText");

    let gameDuration = 30;
    let score;
    let seconds;
    let timer;

    startGame();

    function caughtIt() {
      score++;
      printScore();

      // Verplaats de Octocat direct zodra hij gevangen wordt. Anders kun je
      // gedurende de tijd dat hij niet beweegt blijven scoren
      moveIt();

      // Het aanroepen van `moveIt` zorgt ervoor dat de tijd verder gezet
      // wordt. Als je de Octocat vangt, dan krijg je de seconde dat hij niet
      // bewogen heeft terug
      resetTimer();
      seconds--;
    }

    function moveIt() {
      seconds++;

      octocat.style.left = Math.random() * 900 + "px";
      octocat.style.top = Math.random() * 700 + "px";

      if (seconds > gameDuration) {
        stopGame();
      }
    }

    function printScore() {
      scoreText.innerText = "Score: " + score;
    }

    function resetTimer() {
      // In het geval dat er een timer actief is, dan moet die eerst gestopt
      // worden aangezien anders de `moveIt` actie te vaak zal worden
      // aangeroepen
      if (timer) {
        clearInterval(timer);
      }

      timer = setInterval(moveIt, 1000);
    }

    function startGame() {
      score = 0;
      printScore();

      seconds = 0;
      resetTimer();

      octocat.addEventListener("click", caughtIt);
    }

    function stopGame() {
      octocat.removeEventListener("click", caughtIt);
      clearInterval(timer);
      alert("Jouw uiteindelijke score is: " + score);
      startGame();
    }
  </script>
</html>
